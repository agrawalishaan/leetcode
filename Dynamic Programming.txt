Try DP from both directions.